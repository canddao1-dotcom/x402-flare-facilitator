# 2026-01-28 - FlareBank DAO Monitoring Setup

## Session Summary
Built comprehensive on-chain data queries for FlareBank DAO treasury and protocol monitoring.

## FlareBank Protocol - Core Concepts
- **TVL-backed token**: Price scales with TVL (+0.01 wFLR per BANK for every 10,000 wFLR added)
- **Starting price**: 1 wFLR/BANK
- **Three components**: Main Contract, IBDP (delegation pot), DAO Treasury

### Fee Structure
- **10% on mints/burns** via FB Main
- **1% on LP swaps** or BANK token transfers

### Fee Distribution
- 8% → BANK holders
- 1.5% → Team/Dev
- 0.5% → DAO Treasury

### DAO Revenue Streams
1. 0.5% of Mint/burn/transfer fees
2. FLR Drops to TVL
3. Delegation rewards
4. IBDP staking rewards
5. Fees to its BANK token holdings

## Key Addresses

### Protocol Contracts
| Contract | Address |
|----------|---------|
| BANK Token (Main) | `0x194726F6C2aE988f1Ab5e1C943c17e591a6f6059` |
| IBDP | `0x90679234fe693b39bfdf5642060cb10571adc59b` |
| DAO Treasury | `0xaa68bc4bab9a63958466f49f5a58c54a412d4906` |

### Token Contracts
| Token | Address | Decimals |
|-------|---------|----------|
| WFLR | `0x1D80c49BbBCd1C0911346656B529DF9E5c2F783d` | 18 |
| FXRP | `0xad552a648c74d49e10027ab8a618a3ad4901c5be` | 6 |
| sFLR | `0x12e605bc104e93B45e1aD99F9e555f659051c2BB` | 18 |
| APS | `0xff56eb5b1a7faa972291117e5e9565da29bc808d` | 18 |
| stXRP | `0x4c18ff3c89632c3dd62e796c0afa5c07c4c1b2b3` | 6 |

### LP Positions (DAO)
| Pool | Contract | DEX |
|------|----------|-----|
| BANK/WFLR V2 | `0x5f29c8d049e47dd180c2b83e3560e8e271110335` | Enosys |
| BANK/WFLR V2 | `0x0f574fc895c1abf82aeff334fa9d8ba43f866111` | SparkDex |
| stXRP/FXRP V3 | Position #28509 | Enosys |

### Enosys V3 Contracts
| Contract | Address |
|----------|---------|
| Position Manager | `0xd9770b1c7a6ccd33c75b5bcb1c0078f46be46657` |
| Factory | `0x17aa157ac8c54034381b840cb8f6bf7fc355f0de` |
| stXRP/FXRP Pool | `0xa4ce7dafc6fb5aceedd0070620b72ab8f09b0770` |

### CDP Earn Pools
| Pool | Contract |
|------|----------|
| FXRP CDP | `0x2c817F7159c08d94f09764086330c96Bb3265A2f` |
| WFLR CDP | `0x0Dd6daab4cB9A0ba6707Cf59DBfbc28cc33CA24A` |

### Staking
| Contract | Address |
|----------|---------|
| APS Staking | `0x7eb8ceb0f64d934a31835b98eb4cbab3ca56df28` |

## Function Selectors Discovered

### FlareBank Main
```
totalSupply() => 0x18160ddd
buyPrice() => 0x8620410b
sellPrice() => 0x4b750334
nextClaimEpoch() => 0x96137390
```

### Stability Pool (CDP Earn)
```
getCompoundedBoldDeposit(address) => 0x065f566d
getDepositorYieldGain(address) => 0xdaed0a9b
getDepositorCollGain(address) => 0x47ea8354
```

### V3 Position
```
positions(uint256) => 0x99fbab88
slot0() => 0x3850c7bd
```

## Scripts Created
- `flarebank/scripts/dao-balance.mjs` - All DAO treasury positions
- `flarebank/scripts/dao-balance-json.mjs` - JSON output
- `flarebank/scripts/protocol-stats.mjs` - Main + IBDP protocol metrics

## What We Can Query
✅ All wallet token balances
✅ V2 LP positions (Enosys + SparkDex)
✅ V3 LP position #28509 with calculated amounts
✅ CDP Earn pools with pending rewards
✅ APS staking
✅ Protocol TVL (Main + IBDP)
✅ BANK prices (buy/sell/AMM)
✅ Next claim epoch

## User Context
- Ser (canddao) is founder of FlareBank
- Focus on crypto futures trading
- @FlareBank on X, @Canddao personal X
